{"ast":null,"code":"var _jsxFileName = \"/Users/naringles/Desktop/OneStorage/frontend/src/components/DriveList.jsx\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport axios from \"axios\";\nimport { useHistory } from \"react-router-dom\";\nimport { LoginContext } from \"./LoginContext\";\nimport { DrivesContext, DriveDeleteContext } from \"./DrivesRepo\";\nimport { FilesContext } from \"./FilesRepo\";\nimport FolderChoices from \"./FolderChoices\";\nimport { SearchContext } from \"./SearchContext\";\nimport Progress from \"./UploadProgressBar\";\nimport _ from 'lodash';\nimport { ProgressBar, Card } from 'react-bootstrap';\nimport { FaGoogleDrive, FaDropbox } from \"react-icons/fa\";\nimport { GrOnedrive } from \"react-icons/gr\";\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { confirmAlert } from 'react-confirm-alert'; // Import\n\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import css\n\nfunction DriveList({\n  match\n}) {\n  let history = useHistory();\n  const [loggedIn, setLoggedIn] = useContext(LoginContext);\n  const {\n    drives,\n    setDrives\n  } = useContext(DrivesContext);\n  const {\n    driveDeleted,\n    setDriveDeleted\n  } = useContext(DriveDeleteContext);\n  const [driveUsage, setDriveUsage] = useState({});\n  const [driveUsagePct, setDriveUsagePct] = useState();\n  const [driveTypes, setDriveTypes] = useState({\n    googleDrive: \"\",\n    oneDrive: \"\",\n    dropbox: \"\"\n  });\n  const [driveExpand, setDriveExpand] = useState(\"\");\n  useEffect(() => {\n    if (drives.length > 0) {\n      setDriveUsage(drives.map(drive => ({\n        usage: parseFloat(drive.storageUsage),\n        limit: parseFloat(drive.storageLimit)\n      })).reduce((x, y) => ({\n        usage: x.usage + y.usage,\n        limit: x.limit + y.limit\n      })));\n      setDriveTypes({\n        googleDrive: drives.filter(drive => drive.storageType === \"googleDrive\").length,\n        oneDrive: drives.filter(drive => drive.storageType === \"oneDrive\").length,\n        dropbox: drives.filter(drive => drive.storageType === \"dropbox\").length\n      });\n    }\n  }, [drives]);\n  useEffect(() => {\n    setDriveUsagePct(driveUsage.usage / driveUsage.limit * 100);\n  }, [driveUsage]);\n\n  const handleSelect = event => {\n    if (driveExpand.length === 0) setDriveExpand(event.target.attributes.getNamedItem(\"name\").value);else setDriveExpand(\"\");\n  };\n\n  const handleDelSubmit = driveIdDelete => {\n    confirmAlert({\n      title: 'Confirm to Delete',\n      message: 'Are you sure to delete this drive.',\n      buttons: [{\n        label: 'Yes',\n        onClick: () => handleDelete(driveIdDelete)\n      }, {\n        label: 'No',\n        onClick: () => null\n      }]\n    });\n  };\n\n  const handleDelete = (driveId, driveType, event) => {\n    console.log(\"id to delete: \", driveId);\n    axios.post('/action/drive/delete', {\n      driveIdDelete: driveId\n    }).then(resp => {\n      if (resp.data.success) {\n        setDrives(drives.filter(drive => drive.id !== driveId));\n        window.location.reload();\n      }\n\n      setDriveDeleted({\n        status: resp.data.success,\n        message: resp.data.message\n      });\n      setTimeout(() => setDriveDeleted({\n        status: false,\n        message: \"\"\n      }), 10000);\n    }).catch(err => {\n      console.error(err);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    style: {\n      padding: \"0% 0% 1% 2%\",\n      margin: \"0% 2% 1% 5%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FolderChoices, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 5\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    style: {\n      padding: \"0% 0% 1% 2%\",\n      margin: \"0% 2% 1% 5%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cardHeader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Card.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 33\n    }\n  }, \"Storage Info\")), /*#__PURE__*/React.createElement(Card.Body, {\n    style: {\n      padding: \"2% 1% 0% 2%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Card.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 5\n    }\n  }, driveUsagePct >= 90 ? /*#__PURE__*/React.createElement(ProgressBar, {\n    now: driveUsagePct,\n    variant: \"danger\",\n    label: `${(driveUsage.usage / driveUsage.limit * 100).toFixed(2)}%`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 28\n    }\n  }) : driveUsagePct >= 75 ? /*#__PURE__*/React.createElement(ProgressBar, {\n    now: driveUsagePct,\n    variant: \"warning\",\n    label: `${(driveUsage.usage / driveUsage.limit * 100).toFixed(2)}%`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 28\n    }\n  }) : /*#__PURE__*/React.createElement(ProgressBar, {\n    style: {\n      width: \"15vw\"\n    },\n    now: driveUsagePct,\n    variant: \"success\",\n    label: `${(driveUsage.usage / driveUsage.limit * 100).toFixed(2)}%`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 6\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  }, \"Total Limit : \", (driveUsage.limit / (1024 * 1024 * 1024)).toFixed(2), \" GB\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, \"Total Usage : \", (driveUsage.usage / (1024 * 1024 * 1024)).toFixed(2), \" GB\"))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    style: {\n      padding: \"0% 0% 1% 2%\",\n      margin: \"0% 2% 1% 5%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cardHeader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Card.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 33\n    }\n  }, \"Drives Info\")), /*#__PURE__*/React.createElement(Card.Body, {\n    style: {\n      padding: \"0% 1% 0% 2%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"list-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    onClick: handleSelect,\n    className: \"list-group-item\",\n    name: \"googleDrive\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }\n  }, \" \", /*#__PURE__*/React.createElement(FaGoogleDrive, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 82\n    }\n  }), \" : \", driveTypes.googleDrive, \" drives added \"), /*#__PURE__*/React.createElement(\"li\", {\n    onClick: handleSelect,\n    className: \"list-group-item\",\n    name: \"oneDrive\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }\n  }, \" \", /*#__PURE__*/React.createElement(GrOnedrive, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 79\n    }\n  }), \" : \", driveTypes.oneDrive, \" drive\", parseInt(driveTypes.oneDrive) > 1 && \"s\", \" added \"), /*#__PURE__*/React.createElement(\"li\", {\n    onClick: handleSelect,\n    className: \"list-group-item\",\n    name: \"dropbox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }, \" \", /*#__PURE__*/React.createElement(FaDropbox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 78\n    }\n  }), \" : \", driveTypes.dropbox, \" drive\", parseInt(driveTypes.dropbox) > 1 && \"s\", \" added \"), driveExpand.length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"driveList\",\n    style: {\n      marginTop: \"5%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }\n  }, driveExpand, \"(s)\"), drives.filter(drive => drive.storageType === driveExpand).map(drive => /*#__PURE__*/React.createElement(\"ol\", {\n    key: drive.id,\n    style: {\n      fontSize: \"smaller\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    style: {\n      padding: \"0\",\n      margin: \"0\"\n    },\n    className: \"list-group-item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }, \"  \", drive.email, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 91\n    }\n  }), /*#__PURE__*/React.createElement(Progress, {\n    percentage: Math.round(parseInt(drive.storageUsage) / parseFloat(drive.storageLimit) * 10000) / 100,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"fileDelete\",\n    onClick: e => handleDelSubmit(drive.id, e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 11\n    }\n  }, \" \", /*#__PURE__*/React.createElement(DeleteIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 86\n    }\n  })))))) : null)))))));\n}\n\nexport default DriveList;","map":{"version":3,"sources":["/Users/naringles/Desktop/OneStorage/frontend/src/components/DriveList.jsx"],"names":["React","useState","useEffect","useContext","axios","useHistory","LoginContext","DrivesContext","DriveDeleteContext","FilesContext","FolderChoices","SearchContext","Progress","_","ProgressBar","Card","FaGoogleDrive","FaDropbox","GrOnedrive","DeleteIcon","confirmAlert","DriveList","match","history","loggedIn","setLoggedIn","drives","setDrives","driveDeleted","setDriveDeleted","driveUsage","setDriveUsage","driveUsagePct","setDriveUsagePct","driveTypes","setDriveTypes","googleDrive","oneDrive","dropbox","driveExpand","setDriveExpand","length","map","drive","usage","parseFloat","storageUsage","limit","storageLimit","reduce","x","y","filter","storageType","handleSelect","event","target","attributes","getNamedItem","value","handleDelSubmit","driveIdDelete","title","message","buttons","label","onClick","handleDelete","driveId","driveType","console","log","post","then","resp","data","success","id","window","location","reload","status","setTimeout","catch","err","error","padding","margin","toFixed","width","parseInt","marginTop","fontSize","email","Math","round","e"],"mappings":"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","sourcesContent":["import React, { useState, useEffect,useContext } from \"react\";\nimport axios from \"axios\";\nimport {useHistory} from \"react-router-dom\";\nimport {LoginContext} from \"./LoginContext\";\nimport {DrivesContext,DriveDeleteContext} from \"./DrivesRepo\";\nimport {FilesContext} from \"./FilesRepo\";\nimport FolderChoices from \"./FolderChoices\";\nimport {SearchContext} from \"./SearchContext\";\nimport Progress from \"./UploadProgressBar\";\nimport _ from 'lodash';\nimport {ProgressBar, Card}  from 'react-bootstrap';\nimport {FaGoogleDrive,FaDropbox} from \"react-icons/fa\";\nimport {GrOnedrive} from \"react-icons/gr\";\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { confirmAlert } from 'react-confirm-alert'; // Import\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import css\n\nfunction DriveList({ match }) {\n  let history = useHistory();\n  const [loggedIn, setLoggedIn] = useContext(LoginContext);\n  const {drives, setDrives} = useContext(DrivesContext);\n  const {driveDeleted,setDriveDeleted} = useContext(DriveDeleteContext);\n  const [driveUsage, setDriveUsage] = useState({});\n  const [driveUsagePct, setDriveUsagePct] = useState();\n  const [driveTypes, setDriveTypes] = useState({googleDrive:\"\",oneDrive:\"\",dropbox:\"\"});\n  const [driveExpand, setDriveExpand] = useState(\"\");\n  useEffect(() => {\n    if(drives.length>0){\n    setDriveUsage(drives.map(drive=>  ({usage:parseFloat(drive.storageUsage),limit:parseFloat(drive.storageLimit)})).reduce((x,y)=>({usage:x.usage+y.usage,limit:x.limit+y.limit})));    \n    setDriveTypes({googleDrive:drives.filter(drive => drive.storageType===\"googleDrive\").length,\n    oneDrive:drives.filter(drive => drive.storageType===\"oneDrive\").length,\n    dropbox:drives.filter(drive => drive.storageType===\"dropbox\").length});\n    }\n\n  },[drives])\n\nuseEffect(() => {\n  setDriveUsagePct((driveUsage.usage/driveUsage.limit)*100);    \n  },[driveUsage])\n  \nconst handleSelect =(event)=>{\n  if(driveExpand.length===0)  \n  setDriveExpand(event.target.attributes.getNamedItem(\"name\").value);\n  else\n  setDriveExpand(\"\");\n}\n\nconst handleDelSubmit = (driveIdDelete) => {\n  confirmAlert({\n    title: 'Confirm to Delete',\n    message: 'Are you sure to delete this drive.',\n    buttons: [\n      {\n        label: 'Yes',\n        onClick: () => handleDelete(driveIdDelete)\n      },\n      {\n        label: 'No',\n        onClick: () => null\n      }\n    ]\n  });\n};\n\nconst handleDelete = (driveId,driveType,event)=>{ \n      \n       console.log(\"id to delete: \",driveId);\n  \n  axios\n  .post('/action/drive/delete', {driveIdDelete:driveId})\n  .then((resp)=>\n  {\n      if(resp.data.success)\n      {\n        setDrives(drives.filter(drive=>drive.id !==driveId));\n        window.location.reload();\n      }\n      setDriveDeleted({status:resp.data.success,message:resp.data.message});\n      setTimeout(()=> setDriveDeleted({status:false,message:\"\"}),10000);\n  })\n  .catch(err => {\n    console.error(err);\n  });\n  \n  \n  \n}\n  return (\n    <div>\n    <div className=\"row\">\n    <div className=\"col\"  style={{padding:\"0% 0% 1% 2%\",margin:\"0% 2% 1% 5%\"}}>\n    <FolderChoices/>\n    </div>\n    </div>\n    <div className=\"row\">\n    <div className=\"col\" style={{padding:\"0% 0% 1% 2%\",margin:\"0% 2% 1% 5%\"}}>\n    <Card>\n    <div className=\"cardHeader\"><Card.Header>Storage Info</Card.Header></div>\n    <Card.Body style={{padding:\"2% 1% 0% 2%\"}}>\n    <Card.Title>\n    {driveUsagePct >= 90 ? <ProgressBar now={driveUsagePct} variant=\"danger\"  label={`${((driveUsage.usage/driveUsage.limit)*100).toFixed(2)}%`}/>:\n     driveUsagePct >= 75 ? <ProgressBar now={driveUsagePct} variant=\"warning\"  label={`${((driveUsage.usage/driveUsage.limit)*100).toFixed(2)}%`}/>:\n     <ProgressBar style={{width:\"15vw\"}} now={driveUsagePct} variant=\"success\"  label={`${((driveUsage.usage/driveUsage.limit)*100).toFixed(2)}%`}/>} \n    </Card.Title>      \n      <p>Total Limit : {(driveUsage.limit/(1024*1024*1024)).toFixed(2)} GB</p>\n      <p>Total Usage : {(driveUsage.usage/(1024*1024*1024)).toFixed(2)} GB</p>    \n      </Card.Body>     \n    </Card>\n    </div>\n    </div>\n\n\n    <div className=\"row\">\n    <div className=\"col\"  style={{padding:\"0% 0% 1% 2%\",margin:\"0% 2% 1% 5%\"}}>\n    <Card>\n    <div className=\"cardHeader\"><Card.Header>Drives Info</Card.Header></div>\n    <Card.Body style={{padding:\"0% 1% 0% 2%\"}}>\n    <div className=\"list-group\">\n     <ul>\n    \n      <li onClick={handleSelect} className=\"list-group-item\" name=\"googleDrive\"> <FaGoogleDrive/> : {driveTypes.googleDrive} drives added </li>\n      <li onClick={handleSelect} className=\"list-group-item\" name=\"oneDrive\"> <GrOnedrive/> : {driveTypes.oneDrive} drive{parseInt(driveTypes.oneDrive)>1 && \"s\"} added </li>     \n      <li onClick={handleSelect} className=\"list-group-item\" name=\"dropbox\"> <FaDropbox/> : {driveTypes.dropbox} drive{parseInt(driveTypes.dropbox)>1 && \"s\"} added </li>\n      {driveExpand.length>0 ? \n      <div className=\"driveList\" style={{marginTop:\"5%\"}}>\n      <h5>{driveExpand}(s)</h5>\n        {drives.filter(drive=>drive.storageType===driveExpand).map((drive)=>(\n          <ol key={drive.id} style={{fontSize:\"smaller\"}}>\n          <li style={{padding:\"0\",margin:\"0\"}} className=\"list-group-item\">  {drive.email}<br/> \n          <Progress percentage={(Math.round(parseInt(drive.storageUsage)/parseFloat(drive.storageLimit)*10000)/100)} />          \n          <button className=\"fileDelete\" onClick={(e)=>handleDelSubmit(drive.id,e)}> <DeleteIcon/></button>\n          </li>\n          </ol>\n          \n        ))}\n      \n      </div>\n      :null\n      }\n     </ul>\n     </div>\n\n    </Card.Body>     \n    </Card>\n    </div>\n\n    </div>\n    </div>\n\n  );\n}\n\nexport default DriveList;\n"]},"metadata":{},"sourceType":"module"}