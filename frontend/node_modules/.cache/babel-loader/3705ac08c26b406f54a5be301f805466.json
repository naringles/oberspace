{"ast":null,"code":"import _slicedToArray from\"/Users/naringles/Desktop/OneStorage/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from\"react\";import axios from\"axios\";import{useHistory}from\"react-router-dom\";import{LoginContext}from\"./LoginContext\";import{DrivesContext,DriveDeleteContext}from\"./DrivesRepo\";import{FilesContext}from\"./FilesRepo\";import FolderChoices from\"./FolderChoices\";import{SearchContext}from\"./SearchContext\";import Progress from\"./UploadProgressBar\";import _ from'lodash';import{ProgressBar,Card}from'react-bootstrap';import{FaGoogleDrive,FaDropbox}from\"react-icons/fa\";import{GrOnedrive}from\"react-icons/gr\";import DeleteIcon from'@material-ui/icons/Delete';import{confirmAlert}from'react-confirm-alert';// Import\nimport'react-confirm-alert/src/react-confirm-alert.css';// Import css\nfunction DriveList(_ref){var match=_ref.match;var history=useHistory();var _useContext=useContext(LoginContext),_useContext2=_slicedToArray(_useContext,2),loggedIn=_useContext2[0],setLoggedIn=_useContext2[1];var _useContext3=useContext(DrivesContext),drives=_useContext3.drives,setDrives=_useContext3.setDrives;var _useContext4=useContext(DriveDeleteContext),driveDeleted=_useContext4.driveDeleted,setDriveDeleted=_useContext4.setDriveDeleted;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),driveUsage=_useState2[0],setDriveUsage=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),driveUsagePct=_useState4[0],setDriveUsagePct=_useState4[1];var _useState5=useState({googleDrive:\"\",oneDrive:\"\",dropbox:\"\"}),_useState6=_slicedToArray(_useState5,2),driveTypes=_useState6[0],setDriveTypes=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),driveExpand=_useState8[0],setDriveExpand=_useState8[1];useEffect(function(){if(drives.length>0){setDriveUsage(drives.map(function(drive){return{usage:parseFloat(drive.storageUsage),limit:parseFloat(drive.storageLimit)};}).reduce(function(x,y){return{usage:x.usage+y.usage,limit:x.limit+y.limit};}));setDriveTypes({googleDrive:drives.filter(function(drive){return drive.storageType===\"googleDrive\";}).length,oneDrive:drives.filter(function(drive){return drive.storageType===\"oneDrive\";}).length,dropbox:drives.filter(function(drive){return drive.storageType===\"dropbox\";}).length});}},[drives]);useEffect(function(){setDriveUsagePct(driveUsage.usage/driveUsage.limit*100);},[driveUsage]);var handleSelect=function handleSelect(event){if(driveExpand.length===0)setDriveExpand(event.target.attributes.getNamedItem(\"name\").value);else setDriveExpand(\"\");};var handleDelSubmit=function handleDelSubmit(driveIdDelete){confirmAlert({title:'Confirm to Delete',message:'Are you sure to delete this drive.',buttons:[{label:'Yes',onClick:function onClick(){return handleDelete(driveIdDelete);}},{label:'No',onClick:function onClick(){return null;}}]});};var handleDelete=function handleDelete(driveId,driveType,event){console.log(\"id to delete: \",driveId);axios.post('/action/drive/delete',{driveIdDelete:driveId}).then(function(resp){if(resp.data.success){setDrives(drives.filter(function(drive){return drive.id!==driveId;}));window.location.reload();}setDriveDeleted({status:resp.data.success,message:resp.data.message});setTimeout(function(){return setDriveDeleted({status:false,message:\"\"});},10000);}).catch(function(err){console.error(err);});};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\",style:{padding:\"0% 0% 1% 2%\",margin:\"0% 2% 1% 5%\"}},/*#__PURE__*/React.createElement(FolderChoices,null))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\",style:{padding:\"0% 0% 1% 2%\",margin:\"0% 2% 1% 5%\"}},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(\"div\",{className:\"cardHeader\"},/*#__PURE__*/React.createElement(Card.Header,null,\"Storage Info\")),/*#__PURE__*/React.createElement(Card.Body,{style:{padding:\"2% 1% 0% 2%\"}},/*#__PURE__*/React.createElement(Card.Title,null,driveUsagePct>=90?/*#__PURE__*/React.createElement(ProgressBar,{now:driveUsagePct,variant:\"danger\",label:\"\".concat((driveUsage.usage/driveUsage.limit*100).toFixed(2),\"%\")}):driveUsagePct>=75?/*#__PURE__*/React.createElement(ProgressBar,{now:driveUsagePct,variant:\"warning\",label:\"\".concat((driveUsage.usage/driveUsage.limit*100).toFixed(2),\"%\")}):/*#__PURE__*/React.createElement(ProgressBar,{style:{width:\"15vw\"},now:driveUsagePct,variant:\"success\",label:\"\".concat((driveUsage.usage/driveUsage.limit*100).toFixed(2),\"%\")})),/*#__PURE__*/React.createElement(\"p\",null,\"Total Limit : \",(driveUsage.limit/(1024*1024*1024)).toFixed(2),\" GB\"),/*#__PURE__*/React.createElement(\"p\",null,\"Total Usage : \",(driveUsage.usage/(1024*1024*1024)).toFixed(2),\" GB\"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\",style:{padding:\"0% 0% 1% 2%\",margin:\"0% 2% 1% 5%\"}},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(\"div\",{className:\"cardHeader\"},/*#__PURE__*/React.createElement(Card.Header,null,\"Drives Info\")),/*#__PURE__*/React.createElement(Card.Body,{style:{padding:\"0% 1% 0% 2%\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"list-group\"},/*#__PURE__*/React.createElement(\"ul\",null,/*#__PURE__*/React.createElement(\"li\",{onClick:handleSelect,className:\"list-group-item\",name:\"googleDrive\"},\" \",/*#__PURE__*/React.createElement(FaGoogleDrive,null),\" : \",driveTypes.googleDrive,\" drives added \"),/*#__PURE__*/React.createElement(\"li\",{onClick:handleSelect,className:\"list-group-item\",name:\"oneDrive\"},\" \",/*#__PURE__*/React.createElement(GrOnedrive,null),\" : \",driveTypes.oneDrive,\" drive\",parseInt(driveTypes.oneDrive)>1&&\"s\",\" added \"),/*#__PURE__*/React.createElement(\"li\",{onClick:handleSelect,className:\"list-group-item\",name:\"dropbox\"},\" \",/*#__PURE__*/React.createElement(FaDropbox,null),\" : \",driveTypes.dropbox,\" drive\",parseInt(driveTypes.dropbox)>1&&\"s\",\" added \"),driveExpand.length>0?/*#__PURE__*/React.createElement(\"div\",{className:\"driveList\",style:{marginTop:\"5%\"}},/*#__PURE__*/React.createElement(\"h5\",null,driveExpand,\"(s)\"),drives.filter(function(drive){return drive.storageType===driveExpand;}).map(function(drive){return/*#__PURE__*/React.createElement(\"ol\",{key:drive.id,style:{fontSize:\"smaller\"}},/*#__PURE__*/React.createElement(\"li\",{style:{padding:\"0\",margin:\"0\"},className:\"list-group-item\"},\"  \",drive.email,/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Progress,{percentage:Math.round(parseInt(drive.storageUsage)/parseFloat(drive.storageLimit)*10000)/100}),/*#__PURE__*/React.createElement(\"button\",{className:\"fileDelete\",onClick:function onClick(e){return handleDelSubmit(drive.id,e);}},\" \",/*#__PURE__*/React.createElement(DeleteIcon,null))));})):null)))))));}export default DriveList;","map":{"version":3,"sources":["/Users/naringles/Desktop/OneStorage/frontend/src/components/DriveList.jsx"],"names":["React","useState","useEffect","useContext","axios","useHistory","LoginContext","DrivesContext","DriveDeleteContext","FilesContext","FolderChoices","SearchContext","Progress","_","ProgressBar","Card","FaGoogleDrive","FaDropbox","GrOnedrive","DeleteIcon","confirmAlert","DriveList","match","history","loggedIn","setLoggedIn","drives","setDrives","driveDeleted","setDriveDeleted","driveUsage","setDriveUsage","driveUsagePct","setDriveUsagePct","googleDrive","oneDrive","dropbox","driveTypes","setDriveTypes","driveExpand","setDriveExpand","length","map","drive","usage","parseFloat","storageUsage","limit","storageLimit","reduce","x","y","filter","storageType","handleSelect","event","target","attributes","getNamedItem","value","handleDelSubmit","driveIdDelete","title","message","buttons","label","onClick","handleDelete","driveId","driveType","console","log","post","then","resp","data","success","id","window","location","reload","status","setTimeout","catch","err","error","padding","margin","toFixed","width","parseInt","marginTop","fontSize","email","Math","round","e"],"mappings":"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","sourcesContent":["import React, { useState, useEffect,useContext } from \"react\";\nimport axios from \"axios\";\nimport {useHistory} from \"react-router-dom\";\nimport {LoginContext} from \"./LoginContext\";\nimport {DrivesContext,DriveDeleteContext} from \"./DrivesRepo\";\nimport {FilesContext} from \"./FilesRepo\";\nimport FolderChoices from \"./FolderChoices\";\nimport {SearchContext} from \"./SearchContext\";\nimport Progress from \"./UploadProgressBar\";\nimport _ from 'lodash';\nimport {ProgressBar, Card}  from 'react-bootstrap';\nimport {FaGoogleDrive,FaDropbox} from \"react-icons/fa\";\nimport {GrOnedrive} from \"react-icons/gr\";\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { confirmAlert } from 'react-confirm-alert'; // Import\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import css\n\nfunction DriveList({ match }) {\n  let history = useHistory();\n  const [loggedIn, setLoggedIn] = useContext(LoginContext);\n  const {drives, setDrives} = useContext(DrivesContext);\n  const {driveDeleted,setDriveDeleted} = useContext(DriveDeleteContext);\n  const [driveUsage, setDriveUsage] = useState({});\n  const [driveUsagePct, setDriveUsagePct] = useState();\n  const [driveTypes, setDriveTypes] = useState({googleDrive:\"\",oneDrive:\"\",dropbox:\"\"});\n  const [driveExpand, setDriveExpand] = useState(\"\");\n  useEffect(() => {\n    if(drives.length>0){\n    setDriveUsage(drives.map(drive=>  ({usage:parseFloat(drive.storageUsage),limit:parseFloat(drive.storageLimit)})).reduce((x,y)=>({usage:x.usage+y.usage,limit:x.limit+y.limit})));    \n    setDriveTypes({googleDrive:drives.filter(drive => drive.storageType===\"googleDrive\").length,\n    oneDrive:drives.filter(drive => drive.storageType===\"oneDrive\").length,\n    dropbox:drives.filter(drive => drive.storageType===\"dropbox\").length});\n    }\n\n  },[drives])\n\nuseEffect(() => {\n  setDriveUsagePct((driveUsage.usage/driveUsage.limit)*100);    \n  },[driveUsage])\n  \nconst handleSelect =(event)=>{\n  if(driveExpand.length===0)  \n  setDriveExpand(event.target.attributes.getNamedItem(\"name\").value);\n  else\n  setDriveExpand(\"\");\n}\n\nconst handleDelSubmit = (driveIdDelete) => {\n  confirmAlert({\n    title: 'Confirm to Delete',\n    message: 'Are you sure to delete this drive.',\n    buttons: [\n      {\n        label: 'Yes',\n        onClick: () => handleDelete(driveIdDelete)\n      },\n      {\n        label: 'No',\n        onClick: () => null\n      }\n    ]\n  });\n};\n\nconst handleDelete = (driveId,driveType,event)=>{ \n      \n       console.log(\"id to delete: \",driveId);\n  \n  axios\n  .post('/action/drive/delete', {driveIdDelete:driveId})\n  .then((resp)=>\n  {\n      if(resp.data.success)\n      {\n        setDrives(drives.filter(drive=>drive.id !==driveId));\n        window.location.reload();\n      }\n      setDriveDeleted({status:resp.data.success,message:resp.data.message});\n      setTimeout(()=> setDriveDeleted({status:false,message:\"\"}),10000);\n  })\n  .catch(err => {\n    console.error(err);\n  });\n  \n  \n  \n}\n  return (\n    <div>\n    <div className=\"row\">\n    <div className=\"col\"  style={{padding:\"0% 0% 1% 2%\",margin:\"0% 2% 1% 5%\"}}>\n    <FolderChoices/>\n    </div>\n    </div>\n    <div className=\"row\">\n    <div className=\"col\" style={{padding:\"0% 0% 1% 2%\",margin:\"0% 2% 1% 5%\"}}>\n    <Card>\n    <div className=\"cardHeader\"><Card.Header>Storage Info</Card.Header></div>\n    <Card.Body style={{padding:\"2% 1% 0% 2%\"}}>\n    <Card.Title>\n    {driveUsagePct >= 90 ? <ProgressBar now={driveUsagePct} variant=\"danger\"  label={`${((driveUsage.usage/driveUsage.limit)*100).toFixed(2)}%`}/>:\n     driveUsagePct >= 75 ? <ProgressBar now={driveUsagePct} variant=\"warning\"  label={`${((driveUsage.usage/driveUsage.limit)*100).toFixed(2)}%`}/>:\n     <ProgressBar style={{width:\"15vw\"}} now={driveUsagePct} variant=\"success\"  label={`${((driveUsage.usage/driveUsage.limit)*100).toFixed(2)}%`}/>} \n    </Card.Title>      \n      <p>Total Limit : {(driveUsage.limit/(1024*1024*1024)).toFixed(2)} GB</p>\n      <p>Total Usage : {(driveUsage.usage/(1024*1024*1024)).toFixed(2)} GB</p>    \n      </Card.Body>     \n    </Card>\n    </div>\n    </div>\n\n\n    <div className=\"row\">\n    <div className=\"col\"  style={{padding:\"0% 0% 1% 2%\",margin:\"0% 2% 1% 5%\"}}>\n    <Card>\n    <div className=\"cardHeader\"><Card.Header>Drives Info</Card.Header></div>\n    <Card.Body style={{padding:\"0% 1% 0% 2%\"}}>\n    <div className=\"list-group\">\n     <ul>\n    \n      <li onClick={handleSelect} className=\"list-group-item\" name=\"googleDrive\"> <FaGoogleDrive/> : {driveTypes.googleDrive} drives added </li>\n      <li onClick={handleSelect} className=\"list-group-item\" name=\"oneDrive\"> <GrOnedrive/> : {driveTypes.oneDrive} drive{parseInt(driveTypes.oneDrive)>1 && \"s\"} added </li>     \n      <li onClick={handleSelect} className=\"list-group-item\" name=\"dropbox\"> <FaDropbox/> : {driveTypes.dropbox} drive{parseInt(driveTypes.dropbox)>1 && \"s\"} added </li>\n      {driveExpand.length>0 ? \n      <div className=\"driveList\" style={{marginTop:\"5%\"}}>\n      <h5>{driveExpand}(s)</h5>\n        {drives.filter(drive=>drive.storageType===driveExpand).map((drive)=>(\n          <ol key={drive.id} style={{fontSize:\"smaller\"}}>\n          <li style={{padding:\"0\",margin:\"0\"}} className=\"list-group-item\">  {drive.email}<br/> \n          <Progress percentage={(Math.round(parseInt(drive.storageUsage)/parseFloat(drive.storageLimit)*10000)/100)} />          \n          <button className=\"fileDelete\" onClick={(e)=>handleDelSubmit(drive.id,e)}> <DeleteIcon/></button>\n          </li>\n          </ol>\n          \n        ))}\n      \n      </div>\n      :null\n      }\n     </ul>\n     </div>\n\n    </Card.Body>     \n    </Card>\n    </div>\n\n    </div>\n    </div>\n\n  );\n}\n\nexport default DriveList;\n"]},"metadata":{},"sourceType":"module"}